[TOC]
#1. 常用方法介绍      
##1.1 增         
###1.1.1 方法     
- #### insert
    + db.{collection}.insert({文档对象(本质就是个json串)})
- #### batchInsert
    + db.{collection}.insert([{文档1}，{文档2}......]) 

###1.1.2 注意
- #### _id
    + 新增数据时，如果文档中没有_id字段，mongodb会自动生成一个12字节的唯一标识作为_id。相当于mysql中的主键。
- #### 文档大小
    + 可保存的单个文档大小为16MB，这个是mongodb的限制，防止设计者设计一些不合理的大文档。
    + mongodb单次可接受的消息体最大为48MB，因此批量插入时每次最多传48MB的内容。
- #### 失败
    + 批量插入时，如果某条失败，那么已插入的数据则插入成功，未插入的数据不再继续插入，batchInsert中断。
    + 也可以使用continueOnError选项，可以使batchInsert忽略错误，将所有的数据都尝试保存一遍，但是该选项在shell中无法使用，在驱动程序中可以使用。

##1.2 删 
###1.2.1 方法
- #### remove
    + db.{collection}.remove({查询条件})。如果不带查询条件，像db.{collection}.remove()这样，就会清空集合所有的文档。

##1.3 查
###1.3.1 方法
- #### find
    + find({查询条件},{返回列})，查询条件是一个对象，每个属性之间是and关系，返回列也是一个对象，如果属性值为1则返回该列，为0不返回。例如:
    db.users.find({username:'test',age:10},{username:1,age:1,sex:1})
- #### 查询条件/操作符  
    + 比较操作符 $lt $lte $lte $gt $gte $ne $eq
        * 用法举例: db.users.find(createTime:{$gt:new Date('2020-01-01')})
    + $or 和 $in
        * $in用法举例   
            db.users.find({username:{$in:['test1','test2','test3']}})
        * $or用法举例   
            db.users.find({$or:[{username:'test1'},{username:'test2'},{username:'test3'}]})。
            $or更加灵活，因为可以对多种条件进行or，如下:db.users.find({$or:[{username:'test1'},{age:{$lt:21}},{username:'test3'}]})。
    + $not
        * 元条件句，作用在其他 **查询条件** 之上，相当于条件取反。
        * 例子: db.user.find({num:{$mod:[5,1]}}),这条语句会查询出num字段除以5余1的数据，也就是1、6、11。加上$not,就可以查出其余数据。db.user.find({num:{$not:{$mod:[5,1]}}})
        * $not 搭配正则使用较多，可以查询出和正则不匹配的数据。**（这里有个疑问，就是在数据库里面做正则的匹配，真的有这样做的场景吗？）**
- #### 操作符的分类
    + **数据操作符** (这个叫法是自己起的，并不一定有这样的叫法，只是帮助更好的分类。)
        * 顾名思义，这种操作符后面跟着的是对象的属性，是用来描述查询时某个属性的条件的。比如 $gt、$lt、$in
    + **元操作符**
        * 是用来描述几个操作符之间的关系的，比如$and、$or。
- #### 特定类型的查询
    + null
        * 当使用null查询时，如db.users.find({name:null}),不仅会把数据库中显示存储 name = null 的数据查询出来，还会将不存在name属性的文档也查询出来。
        * 如果只想查询那些存在name字段且为null的数据，可以结合$exists操作符，如db.users.find({name:{$eq:null,$exists:true}})
    + 正则表达式     
        *  **这一块需要实际的去操作一把**
    + 数组
        * 最基本用法 </br>
            假设books中的文档表示一本书，书的作者author属性是个数组，因为书可能有很多个作者。 db.books.find({author:['zhangsan','lisi','wangwu']}) ，这样就可以查出作者包含 zhangsan **或** lisi **或** wangwu的书了。
        * **$all** </br> 
            如果想查询作者包含 zhangsan **和** lisi **和** wangwu的书，那么就可以用$all来查询，db.books.find({author:{$all:['zhangsan','lisi','wangwu']}})
        * **$size** </br>
            这个操作符可以用于查询特定长度的数组，比如db.books.find({author:{$size:3}}),查询由三个人写的书。 
            </br></br>
            但是该操作符无法和$gt、$lt这种结合使用查询长度范围之内的数组，如果想要这种效果的话，可以在文档中加个字段专门记录数组的长度。
            比如db.books.find({authorSize:{$gt:2}}),查询作者超过2人的书。在新增或者删除作者时需要维护authorSize字段，db.books.update({...},{$push:{author:'qianzanqi'},$inc:{authorSize:1}})


##1.4 改
###1.4.1 方法
- #### update 
    + 完全替换。db.{collection}.update({查询条件},{更新后的文档})，适用文档内容大面积的变化。
    + 筛选器更新。db.{collection}.update({查询条件},{筛选器})，会将目标文档中部分数据进行修改
